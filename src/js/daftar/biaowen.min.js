var jumlah_biaowen,display_per_page=20;function bakar_biaowen(data){var data=[];$(".cb_bakar:checked").each((function(){var biaowen=$(this).data("biaowen").split("#");data.push({no:biaowen[0],id_sumbangan:biaowen[1],biaowen:biaowen[2]})}));var ajax=get_ajax_response("daftar/biaowen/bakar_biaowen","post","bakar_biaowen",data);process_ajax(ajax,"init_filter")}function get_daftar_biaowen(data){var ajax=get_ajax_response("daftar/biaowen/get_biaowen_list","get","daftar_biaowen",data);$.when(ajax).done((function(response){$("div.pagination").empty(),$tbody.empty().css("display","none");var length=response.length;if(length>0){for(var c=0,i=0;i<length;i++){var no=data.page*display_per_page+i+1,id_sumbangan=response[i].id_sumbangan,id_paket_sumbangan=response[i].id_paket_sumbangan,nama_donatur=response[i].nama_donatur,nama_paket=response[i].nama_paket,biaowen=response[i].biaowen,lunas=1==response[i].lunas?"&#10003":"&#215;",bakar=1==response[i].bakar?"&#10003":"&#215",tgl_bakar=null===response[i].tgl_bakar?"-":format_date(response[i].tgl_bakar),total_donasi=convert_number_tocurrency(response[i].total_donasi),add_border=null==response[i+1]||id_paket_sumbangan!=response[i+1].id_paket_sumbangan?" class='border'":"",opacity=void 0===response[i-1]||id_paket_sumbangan!=response[i-1].id_paket_sumbangan?1:0,cb_bakar,tr="                 <tr"+add_border+">                     <td>"+no+"</td>                     <td style='opacity:"+opacity+"'>"+id_paket_sumbangan+"#"+nama_paket+"</td>                     <td style='opacity:"+opacity+"'>"+nama_donatur+"</td>                     <td>"+biaowen+"</td>                     <td>"+lunas+"</td>                     <td>"+bakar+"</td>                     <td>"+tgl_bakar+"</td>                     <td>"+total_donasi+"</td>                     <td>"+(0==response[i].lunas||1==response[i].bakar?"&#215;":"<input type='checkbox' class='cb_bakar' data-biaowen='"+no+"#"+id_sumbangan+"#"+biaowen+"'/>")+"</td>                 </tr>";$tbody.append(tr)}$tbody.fadeIn(400,(function(){create_paginations(data.page,jumlah_biaowen,display_per_page,"#"+data.nama_paket+";"+data.biaowen+";"+data.lunas+";"+data.bakar)}))}}))}function get_total_biaowen(data){var ajax=get_ajax_response("daftar/biaowen/get_biaowen_list","get","total_biaowen",data);$.when(ajax).done((function(response){jumlah_biaowen=response,$("caption").fadeOut(400,(function(){$(this).html("Jumlah Biaowen: "+convert_number_tocurrency(jumlah_biaowen)).fadeIn()}))}))}function init_filter(){var data={nama_paket:$("#nama_paket").val(),biaowen:$("#biaowen").val(),lunas:$("#lunas").val(),bakar:$("#bakar").val()};get_total_biaowen(data),data.page=0,data.display_per_page=display_per_page,get_daftar_biaowen(data)}function init_table_style(){var data;get_responsive_style("table","table.tb_daftar",{padding_left:"110"})}$tbody=$("table.tb_daftar tbody"),$(document).ready((function(){init_table_style(),init_filter(),$("span.search_icon").on("click",(function(){init_filter()})),$("#nama_paket, #biaowen").on("keyup",(function(e){13===e.keyCode&&init_filter()})),$("button.i_btn").on("click",(function(){var jumlah_bakar_biaowen;$(".cb_bakar:checked").length>0?(data=["info",+convert_number_tocurrency($(".cb_bakar:checked").length)+" biaowen akan dibakar.<br>Apakah anda yakin?","bakar_biaowen"],$(this).after(create_dialog("confirm",data,"left: unset;top:40px")).next().slideDown()):($("body").append(create_dialog("simple",["error","Silakan centang biaowen yang akan dibakar."])),$("div.simple_dialog").slideDown())})),$("body").on("click","a.link_pagination",(function(){var filter=$(this).data("pagination").split("#")[1].split(";"),page=parseInt($(this).data("pagination").split("#")[0]),data;get_daftar_biaowen({nama_paket:filter[0],biaowen:filter[1],lunas:filter[2],bakar:filter[3],page:page,display_per_page:display_per_page})}))}));